function r(e){if(typeof e!="string")throw new TypeError("Expected a string");return e.replace(/[|\\{}()[\]^$+*?.]/g,"\\$&").replace(/-/g,"\\x2d")}function h(e,c){if(typeof e!="string"||typeof c!="string")throw new TypeError("Expected a string");const o=new RegExp(`(?:${r(c)}){2,}`,"g");return e.replace(o,c)}function n(){return/[<>:"/\\|?*\u0000-\u001F]/g}function d(){return/^(con|prn|aux|nul|com\d|lpt\d)$/i}function u(e,c){if(typeof e!="string"||typeof c!="string")throw new TypeError("Expected a string");return e.startsWith(c)&&(e=e.slice(c.length)),e.endsWith(c)&&(e=e.slice(0,-c.length)),e}const x=100,f=/[\u0000-\u001F\u0080-\u009F]/g,m=/^\.+(\\|\/)|^\.+$/,w=/\.+$/;function E(e,c={}){if(typeof e!="string")throw new TypeError("Expected a string");const o=c.replacement===void 0?"!":c.replacement;if(n().test(o)&&f.test(o))throw new Error("Replacement string cannot contain reserved filename characters");if(e=e.normalize("NFD"),e=e.replace(m,o),e=e.replace(n(),o),e=e.replace(f,o),e=e.replace(w,""),o.length>0){const t=e[0]===".";e=h(e,o),e=e.length>1?u(e,o):e,!t&&e[0]==="."&&(e=o+e),e[e.length-1]==="."&&(e+=o)}e=d().test(e)?e+o:e;const a=typeof c.maxLength=="number"?c.maxLength:x;if(e.length>a){const t=e.lastIndexOf(".");if(t===-1)e=e.slice(0,a);else{const p=e.slice(0,t),l=e.slice(t);e=p.slice(0,Math.max(1,a-l.length))+l}}return e}export{E as default};
